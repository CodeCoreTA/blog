
<h1><%= @post.title %></h1>
<p> <%= @post.body %> </p>
<% @post.tags.each do |tag| %>
  <div class="label label-primary"><%= tag.name %></div>
<% end %>

<p> created by: <%= @post.user.full_name %> </p>
<div class="">

<% if can? :edit, @post %>
  <%= link_to "Edit", edit_post_path(@post), class: "btn btn-primary btn-sm" %>
<% end %>
<% if can? :destroy, @post %>
  <%= link_to "Delete", post_path(@post), method: "delete",
                                        class: "btn btn-danger btn-sm",
                                        data: {confirm: "Are you sure you want to delete?" }%>
<% end %>
</div>

<!-- Favourites -->
<div class="favourites">
  <% if user_signed_in? && @post.favourited_by?(current_user) %>
    <%= link_to fa_icon("star"), post_favourite_path(@post, @post.favourite_for(current_user)), method: :delete, class: "big-icon", alt: "Favourite" %>
 <% else %>
    <%= link_to fa_icon("star-o"), post_favourites_path(@post), method: :post, class: "big-icon", alt: "Favourite" %>
 <% end %>
 Favourited: <%= pluralize(@post.favourites.count, "time") %>
</div>

<!-- Display Comments -->
<div class="">

  <h4> <%= @post.comments.count %> Comments</h4>
</div>
<div class="">

<% @post.comments.order("created_at DESC").each do |comment| %>
  <%= "#{comment.user.full_name}, #{comment.created_at.strftime("%d %b")}" %>
  <div class="well">
  <%= comment.body %>
  <% if can? :destroy, comment %>
    <%= link_to "Delete",  post_comment_path(@post, comment), {method: :delete,
                                            class: "btn btn-danger btn-sm pull-right",
                                            data: {confirm: "Are you sure you want to delete?"}}%>
  <% end %>
</div>
<% end %>
  </div>

<div class="container">
<!-- New Comment -->
<%= form_for [@post, @comment] do |f| %>
  <div class="form-group">
    <%= f.label "Add a comment" %>
    <%= f.text_area :body, class: "form-control" %>
  </div>
  <div class="form-group">
    <%= f.submit value: "Submit", class: "btn btn-primary" %>
  </div>
  <% end %>
  </div>
